<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Graph Expressive Power</title>
    <meta name="description" content="Project Overview. Based on [*folio](https://github.com/bogoli/-folio) design.">
    <!-- Bootstrap & MDB -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />
    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">
    <!-- Styles -->
    <link rel="shortcut icon" href="/graph-power/assets/img/favicon.ico">
    <link rel="stylesheet" href="/graph-power/assets/css/main.css">

    <link rel="canonical" href="/graph-power/">
    <link type="text/css" href="/graph-power/assets/css/magnifier.css" rel="stylesheet">
    <script type="text/javascript" src="/graph-power/assets/js/magnifier.js"></script>
    <!-- KaTeX -->
    <!-- 
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/katex.min.css" integrity="sha384-D+9gmBxUQogRLqvARvNLmA9hS2x//eK1FhVb9PiU86gmcrBrJAQT8okdJ4LMp2uv" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/katex.min.js" integrity="sha384-483A6DwYfKeDa0Q52fJmxFXkcPCFfnXMoXblOkJ4JcA8zATN6Tm78UNL72AKk+0O" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/contrib/auto-render.min.js" integrity="sha384-yACMu8JWxKzSp/C1YV86pzGiQ/l1YUfE8oPuahJQxzehAjEt2GiQuy/BIvl9KyeF" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>
     -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/katex.min.css" integrity="sha384-Cqd8ihRLum0CCg8rz0hYKPoLZ3uw+gES2rXQXycqnL5pgVQIflxAUDS7ZSjITLb5" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/katex.min.js" integrity="sha384-1Or6BdeNQb0ezrmtGeqQHFpppNd7a/gw29xeiSikBbsb44xu3uAo8c7FwbF5jhbd" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>
  </head>
  <body class="fixed-top-nav ">
    <header>
      <nav id="navbar" class="navbar navbar-light bg-white navbar-expand-sm fixed-top">
        <div class="container">
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>
          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">
              <!-- About -->
              <li class="nav-item active">
                <a class="nav-link" href="/graph-power/">
                  About
                    <span class="sr-only">(current)</span>
                </a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/graph-power/blog/">
                  Blog
                </a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>
    <!-- Content -->
    <div class="container mt-5">
      <div class="post">
        <header class="post-header">
          <h1 class="post-title">
            <span class="font-weight-bold">A Fourier Analysis Approach of Graph Neural Network Expressive Power</span>
          </h1>
        </header>
        <article>
          <p>In the previoux topics, we have looked at the expressive power of a GNN as the ability to solve a task. While these properties are informative about the network abilities, they are extrinsic. Ideed, the expressive power of the network is always linked to its ability to work on a problem or approximate a function. Hopefully, a current line of work propose to analyze an intrinsic property of the GNNs, which is the spectral filtering power of the network filters</p>
          <h3 class="post-title">
            <span class="font-weight-bold">Why spectral filtering as a expressive power property?</span>
          </h3>
          <p>To understand the importance of the spectral analysis of a filter, we first need to take a step back from the GNNs and speak about signal filtering. Let's take a 1D signal \(g:\mathbf{R}\longrightarrow\mathbf{C}\). This signal can be decomposed into different frequencies. The high frequency gives information about the rapidly evolving content of the signal, while the low frequency gives information about the content that stays locally constant. To decompose the signal, we use the Fourier transform:</p>
          <p style="text-align:center;">\(\begin{aligned}
                                              \hat{g}(\omega) = \int_{t\in \mathbf{R} g(t) e^{-2\pi i \omega t} dt,\ \forall \omega \in \mathbf{R}
                                            \end{aligned}\)</p>
          <p>where \(\omega\) is the signal frequency. A high value \(|\hat{g}(\omega)|\) indicates that \(g\) encodes some information that oscillates at frequency \(\omega\).</p>
          <p>Now, let's take a 1D filter \(f:\mathbf{R}\longrightarrow\mathbf{C}\). We can notice that the Fourier transform of the convolution between the filter and the signal is a multiplcation in the spectral domain:</p>
          <p style="text-align:center;">\(\begin{aligned}
                                              \hat{(f * g)}(\omega) = \hat{f}(\omega)\hat{g}(\omega),\ \forall \omega \in \mathbf{R}
                                            \end{aligned}\)</p>
          <p>Thus, convolving the signal \(g\) with the filter \(f\) is equivalent to a frequency selection. The filter \(f\) increases or decreases the frequency components of the signal. A filter can extract different information from a signal, focusing on some part of the signal spectrum. As a consequence, we can speak about the expressive power of a set of filter \(\{f\}_s\) as the spectrum range that they cover. The analysis of the filter frequencies informs us on the frequency information these filters can extract from the signal.</p>
          <h2 class="post-title">
            <span class="font-weight-bold">How do we translate this harmonic analysis of the convolution to the graph CNN?</span>
          </h2>
          <p>We can notice that the basis of function \((e^{-2\pi i \omega t})_{\omega}\) are the eigenfunction of the 1D Laplacian operator \(\Delta = -\frac{d^2}{dt^2}\). We can also notice that the Laplacian matrix \(L\) of a graph is the discrete approximation of the Laplacian operator. Thus, we can extend the Fourier transform to signal on a graph, \(\hat{f}(\omega)=\sum_{node\ i} f(i) u^*_{\omega}(i)\), where \((u_{\omega})_{\omega}\) is the eigenvector of the laplacian matrix \(L\). The inverse Fourier transform is \(f(i) = \sum_{\omega} \hat{f}(\omega) u_{\omega}(i)\). We can use this definition of the graph Fourier transform to define the graph convolution. \(f * g (i) = \sum_{\omega}f(\omega)g(\omega) u_{\omega}(i)\).</p>
          <p>\(\begin{aligned}
                f * g = U diag(g(\omega)) U^T f
              \end{aligned}\)</p>
          <p>Thus, the fourier harmonic analysis of a graph convolution filter is the analysis of the vector \(g(\omega)\), where \(\omega\) are the eigenvalues of the Laplacian.</p>
          <h2 class="post-title">
            <span class="font-weight-bold">Harmonic Analysis of localized graph filters</span>
          </h2>
          <p>In a graph CNN, we are interested in learning the coefficient \(g(\omega)\). There are two major drawbacks by doing so. The first is the learning complexity. Indeed, we learn \(O(n)\) coefficients, while for a CNN the number of coefficients is \(O(1)\). The second is that these filters are not spatially localized. To overcome these problems, one can write the filter \(g(\omega)=\sum_{s=1}^S \theta_s g_s(\omega)\), where \(\theta_s\) are the learnt parameters of the filter and \(g_s\) are functions of the eigenvalue \(\omega\). The convolution between the signal \(f\) and the filter \(g\) can be written</p>
          <p>\(\begin{aligned}
                f * g = \sum_{s=1}^S U diag(g_s(\omega)) U^T f \Theta
              \end{aligned}\)</p>
          <p>The convolution support is defined as \(C_s=U diag(g_s(\omega)) U^T\), which describes how the nodes of a neighborhood are aggregated to update the central node. We can study the expressive power of the graph CNN by studying the spectrum of the convolution support, which correspond to \(g_s(\omega)\).</p>
          <p>\(\begin{aligned}
                g_s(\omega) = diag^{-1}(U^T C_s U)
              \end{aligned}\)</p>
          <p>This analysis is well-suited for Spectral Convolution, where the convolution support is well-defined as a </p>
        </article>
      </div>
    </div>
    <footer class="fixed-bottom">
      <div class="container mt-0">
        &copy; Copyright 2021 Axel Elald.
        Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>.
      </div>
    </footer>
  </body>
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha512-/DXTXr6nQodMUiq+IUJYCt2PPOUjrHJ9wFrqpJ3XkgPNOZVfMok7cRw6CSxyCQxXn6ozlESsSh1/sMCTF1rL/g==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js"  integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>
  <script src="/graph-power/assets/js/common.js"></script>
  <link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/masonry/4.2.2/masonry.pkgd.min.js" integrity="" crossorigin="anonymous"></script>
  <script src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script type="text/javascript">
    // Init Masonry
    var $grid = $('.grid').masonry({
      gutter: 10,
      horizontalOrder: true,
      itemSelector: '.grid-item',
    });
    // layout Masonry after each image loads
    $grid.imagesLoaded().progress( function() {
      $grid.masonry('layout');
    });
  </script>  
</html>



